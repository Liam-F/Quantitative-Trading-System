def database_ini():
 df=pd.DataFrame()
 print "Start constructing the stock database...."
 ticker=["AAPL","GOOG","MSFT","XOM","BRK-A","AMZN","FB","JNJ","GE","T",
         "WFC","JPM","WMT","VZ","PG","PFE","CVX","KO","V","HD","ORCL",
         "CMCSA","INTC","MRK","DIS","PEP","IBM","PM","CSCO","BAC","UNH",
         "MO","C","BMY","AMGN","MDT","GILD","SLB","MCD","MMM","ABBV","KHC",
         "CVS","MA","AGN","UPS","NKE","QCOM","HON","WBA"]
 start='1990-06-25'
 end='2016-08-10'
 for i in range(len(ticker)):
      temp1=Share(ticker[i]).get_historical(start,end)
      temp2=pd.DataFrame(temp1)
      df=pd.concat([df,temp2],axis=0)
      print i+1, "/50 is completed!"
 print "Database construction is completed! "

 df=df[["Symbol","Date","Adj_Close","Open","Volume","High","Low"]]
 df=df.sort_values(by=["Date","Symbol"],ascending=[True,True])
 df["Adj_Close"] = df["Adj_Close"].astype(float)
 df["Open"]=df["Open"].astype(float)
 df["Volume"]=df["Volume"].astype(float)
 df["High"]=df["High"].astype(float)
 df["Low"]=df["Low"].astype(float)


 df.to_sql(con=connection,name="stock_data",flavor="sqlite",if_exists="replace" )
